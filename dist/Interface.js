(()=>{"use strict";const e=[{style:"font-weight:bold",words:["WEBREMOTEWS MPXR interface update","WEBMREMOTEWS Service Notification interface update","WEBREMOTEWS INTERFACE UPDATE","Work Order","CasePart-","workorderNumber","AFC","Contact Name","Facility ID","Contact","Account","Surgeon","When Issue Occurred","Length of Extended Surgical Time","What Software Task When Issue Occurred","EventSummary","lengthOfExternalSurgicalTime","Next Action/Resolution","Description","Was Medtronic Imaging Aborted","Surgery Aborted","Was Navigation Aborted","Type of Surgical Procedure","Was a Patient Involved","Patient Id","Patient Gender","Patient Age Units","Patient Weight","Patient Weight Units","Patient Date of Birth","PEI","Contact Name","Facility ID","Contact","Account","Surgeon","MNAV Comment ID:","MNAV Comment Subject:","MNAV Comment:","MNAV Created By:","MNAV Created Date:","MNAV Case Part:","Date Completed","Action/Resolution","Event confirmed?","Symptom","Most Probable Cause","Probable Cause","Resolution","Verification","System Status","Mechanical Inspection","Mechanical Inspection Failure","Mechanical Inspection Summary of Failure(s)","Does the System Perform as Intended?","Imaging Modalities Failure","Imaging Summary of Failure(s)","Imaging Modalities","Failure Mode","Able To Duplicate The Issue","Findings and Conclusions","Failure Mechanism","Methodology","Tested By Date","Surgeon","Lot #","Cause Code Description","Cause Code","Cause Code Text","Date Received Back","Next Action","Action","Possession","Logs and Archive Uploaded","Software Version","No Return Justification","Finding & conclusions","Resolution confirmed on call","Were hardware parts replaced?","Finding & Conclusions","Returned Unused","Initial Reporter","General Summary of Failure(s)","Is General Failure Resolved?","Hardware Failure","Return Item Status"]},{style:"color:green",words:["Work Order","workorderNumber","Date Completed","CasePart","AFC","Date Completed","Does the System Perform as Intended?","Imaging Modalities Failure","Imaging Summary of Failure(s)","Imaging Modalities","Lot #","Were hardware parts replaced?","Returned Unused","Mechanical Inspection","Mechanical Inspection Failure","Mechanical Inspection Summary of Failure(s)"]},{style:"color:blue",words:["When Issue Occurred","Length of Extended Surgical Time","What Software Task","EventSummary","lengthOfExternalSurgicalTime","Next Action/Resolution","Next Action","Description","Possession","No Return Justification","Software Version","Date Received Back","Logs and Archive Uploaded","PASS","YES","Return Item Status"]},{style:"color:red",words:["Was Medtronic Imaging Aborted","Surgery Aborted","Was Navigation Aborted","Type of Surgical Procedure","Was a Patient Involved","Patient Id","Patient Gender","Patient Age Units","Patient Weight","Patient Weight Units","Patient Date of Birth","PEI","MNAV Created Date:","FAIL"]},{style:"color:purple",words:["Contact Name","Facility ID","Contact","Account","Surgeon","Initial Reporter"]},{style:"background:white",words:["AFC","Lot #"]},{style:"background:yellow",words:["Action/Resolution","Event confirmed?","Symptom","Most Probable Cause","Most probable Cause","Resolution","Verification","System Status","Failure Mode","Able To Duplicate The Issue","Findings and Conclusions","Failure Mechanism","Methodology","Tested By Date","Cause Code Description","Cause Code","Cause Code Text","Probable Cause","Next Action","Action","Resolution confirmed on call","General Summary of Failure(s)","Is General Failure Resolved?","Finding & Conclusions","Hardware Failure"]}],t={"Advance Ablation Solutions (AAS)":{styleWords:e},"Advanced Energy":{styleWords:e},"Advanced Surgical Technologies":{styleWords:e},Airways:{styleWords:e},Aortic:{styleWords:e},"Cardiac Ablation Solutions (CAS)":{styleWords:e},"Cardiac Pacing Therapies (CPT)":{styleWords:e},"China Cranial, Spinal, & Orthopedic Technologies":{styleWords:e},"Coronary and Renal Denervation":{styleWords:e},"CSF Therapies":{styleWords:e},"Deep Brain Stimulation (DBS)":{styleWords:e},"Defibrillation Solutions (DS)":{styleWords:e},"Digital Technologies":{styleWords:e},"Ear, Nose & Throat":{styleWords:e},Endoscopy:{styleWords:e},EndoVenous:{styleWords:e},"ET Imaging":{styleWords:e},"ET Navigation":{styleWords:e},"Extracorporeal Therapies (ECT)":{styleWords:e},"General Surgical Technologies":{styleWords:e},"Mazor Robotics":{styleWords:e},"Mechanical Circulatory Support (MCS)":{styleWords:e},Neurovascular:{styleWords:e},"Patient Care Systems (PCS) and Cardiovascular Diagnostics and Services (CDS)":{styleWords:e},"Patient Management":{styleWords:e},"Patient Monitoring":{styleWords:e},"Pelvic Health (PH)":{styleWords:e},"Peripheral Vascular Health (PVH)":{styleWords:e},"Powered Surgical Solutions (PSS)":{styleWords:e},"Radiofrequency Ablation (RFA)":{styleWords:e},"Robotic Surgical Technologies":{styleWords:e},"Spinal Cord Stimulation (SCS)":{styleWords:e},Spine:{styleWords:e},"Surgical Valve Therapies (SVT)":{styleWords:e},"Targeted Drug Delivery (TDD)":{styleWords:e},"Transcatheter Therapies (TCT)":{styleWords:e},Ventilation:{styleWords:e}},n=Date.now(),r=()=>(Date.now()-n+"ms").padStart(6," "),o=(...e)=>console.log("[IF]",r(),...e),i=(...e)=>console.warn("[IF]",r(),...e),a=/\b[A-Z]{2,4}-\d{3,}\b/;function*l(e){function*t(e){e&&(yield e);const n=e?.querySelectorAll?Array.from(e.querySelectorAll("*")):[];for(const e of n)e.shadowRoot&&(yield*t(e.shadowRoot))}yield*t(e);try{const n=Array.from(e.querySelectorAll("iframe"));for(const e of n)try{const n=e.contentDocument||e.contentWindow?.document;n&&(yield*t(n))}catch(e){}}catch(e){}}function s(e){return(e?.textContent||e?.innerText||"").replace(/\r\n/g,"\n").replace(/\u00A0/g," ").replace(/[ \t]+\n/g,"\n").replace(/[ \t]{2,}/g," ").trim()}function c(){const e=top?.document||document,t=new Set;for(const n of l(e))try{n.querySelectorAll('[role="grid"], table[role="grid"]').forEach((e=>{const n=(e.getAttribute("aria-label")||"").trim();/^source infos?/i.test(n)&&t.add(e)})),n.querySelectorAll('[role="grid"]').forEach((e=>{t.has(e)||Array.from(e.querySelectorAll('[role="columnheader"], th')).map((e=>s(e))).some((e=>/^source information$/i.test(e)))&&t.add(e)}))}catch(e){}return o("findSourceInfosGrids ->",t.size,"grid(s)"),Array.from(t)}async function d(){o("readSourceInfoFromDetails: ensure Details tab"),await g("Details",{timeout:15e3}),function(){let e=0;const t=top?.document||document;for(const n of l(t))try{n.querySelectorAll(".CMPL123RecordDetailSection").forEach((t=>{if(!t.classList.contains("slds-is-open")){const n=t.querySelector(".slds-section__title, button[aria-controls], .slds-section");try{n?.click(),e++}catch(e){}}}))}catch(e){}o("[IF] forceExpandCMPL123Sections opened:",e)}(),await new Promise((e=>setTimeout(e,150)));let e=await b((()=>I(/^\s*Source Information\s*$/i)),{timeout:6e3});e||(window.scrollBy(0,600),await new Promise((e=>setTimeout(e,200))),e=await b((()=>I(/^\s*Source Information\s*$/i)),{timeout:3e3}));let t=C(e);if(t&&t.trim())return o("[IF] CMPL123 primary rich hit, length:",t.length),{html:t,text:""};{o("[IF] primary label empty or not found, checking Local Language…");const e=C(await b((()=>I(/^\s*Source Information\s*\(Local Language\)\s*$/i)),{timeout:4e3}));if(e&&e.trim())return o("[IF] Local Language rich hit, length:",e.length),{html:e,text:""}}o("[IF] CMPL123 selectors failed; falling back to generic label…");const n=await b((()=>function(e){const t=top?.document||document,n=e=>{try{const t=e.innerHTML||"";if(t&&/<\w+/i.test(t))return t;const n=e.shadowRoot;if(n){const e=n.querySelector(".slds-rich-text-editor__output")||n.querySelector("div, span");if(e&&e.innerHTML)return e.innerHTML}}catch(e){}return e.innerHTML||""};for(const r of l(t))try{const t=Array.from(r.querySelectorAll("*")).find((t=>e.test((t.textContent||"").trim())));if(!t)continue;const o=t.closest("records-record-layout-item, lightning-layout, div, section")||t.parentElement;if(!o)continue;const i=o.querySelector("lightning-formatted-rich-text, lightning-output-rich-text, lightning-base-formatted-rich-text");if(i)return{type:"rich",node:i,html:n(i)};const a=o.querySelector('lightning-base-formatted-text, lightning-formatted-text, [data-output-element-id="output-field"]');if(a)return{type:"text",node:a}}catch(e){}return null}(/^\s*Source\s*Information\s*$/i)),{timeout:3e3});return n?"rich"===n.type?{html:n.html||n.node?.innerHTML||"",text:""}:{html:"",text:s(n.node)}:{html:"",text:""}}let u=null;function f(e){const t=[],n=e.querySelectorAll('[role="row"]');o("harvestRowsFromGrid scanning rows:",n.length);let r=0;return n.forEach((e=>{const n=e.querySelectorAll('td[role="gridcell"]'),a=parseInt(e.getAttribute("aria-rowindex")||"",10);r+=1;const c=Number.isFinite(a)?a:r;let d="",u="",f=null;const h=function(){const t=performance.now();try{return function(e){const t=e.querySelector('th[role="rowheader"][data-label="Source Info ID"]');if(t){const e=t.querySelector("a[href]");if(e){const t=e.getAttribute("href")||e.href;return o("Row link via rowheader:",t),t}}const n=e.querySelector("records-hoverable-link a[href]");if(n){const e=n.getAttribute("href")||n.href;return o("Row link via hoverable-link:",e),e}const r=Array.from(e.querySelectorAll("a[href]")),a=r.find((e=>/SourceInfo-\d{3,}/i.test((e.textContent||"").trim())));if(a){const e=a.getAttribute("href")||a.href;return o("Row link via text match:",e),e}const l=r.find((e=>/\/lightning\/r\/a5A\w+\/view/i.test(e.getAttribute("href")||e.href||"")));if(l){const e=l.getAttribute("href")||l.href;return o("Row link via id prefix:",e),e}return i("No Source Info link found in row."),null}(e)}finally{const e=(performance.now()-t).toFixed(1);o(`findSourceInfoLinkInRow took ${e}ms`)}}();n.forEach((e=>{const t=(e.getAttribute("data-label")||"").trim(),n=(e.getAttribute("data-col-key-value")||"").trim();if(/^source information$/i.test(t)||/Source_Information/i.test(n)){const t=e.querySelector("lightning-formatted-rich-text, lightning-output-rich-text, lightning-base-formatted-rich-text");if(t&&t.innerHTML)u=function(e){if(!e)return"";const t=new Set(["P","DIV","BR","SPAN","STRONG","B","EM","I","U","UL","OL","LI","HR"]),n=new Set(["font-weight","font-style","text-decoration","color","background-color"]),r=document.createElement("template");r.innerHTML=e;const o=e=>{if(e.nodeType!==Node.COMMENT_NODE){if(e.nodeType===Node.ELEMENT_NODE){const r=e.tagName;if(!t.has(r)){const t=e.parentNode;for(;e.firstChild;)t.insertBefore(e.firstChild,e);return void t.removeChild(e)}for(const t of Array.from(e.attributes)){const o=t.name.toLowerCase(),i=t.value;if("style"===o&&"SPAN"===r){const t=[];i.split(";").forEach((e=>{const[r,o]=e.split(":");if(!r||!o)return;const i=r.trim().toLowerCase();n.has(i)&&t.push(`${i}:${o.trim()}`)})),t.length?e.setAttribute("style",t.join(";")):e.removeAttribute("style")}else e.removeAttribute(t.name)}}for(const t of Array.from(e.childNodes))o(t)}else e.remove()};return o(r.content),r.innerHTML.replace(/\r\n/g,"\n").replace(/\n{3,}/g,"\n\n")}(t.innerHTML);else{const t=e.querySelector("lightning-base-formatted-text, lightning-formatted-text, lst-basic-rich-text"),n=t?.innerHTML;d=n?function(e){if(!e)return"";let t=e;return t=t.replace(/\r\n/g,"\n"),t=t.replace(/<(?:p|div|section|article|h[1-6])\b[^>]*>/gi,"\n").replace(/<\/(?:p|div|section|article|h[1-6])>/gi,"\n"),t=t.replace(/<br\s*\/?>/gi,"\n"),t=t.replace(/<li\b[^>]*>/gi,"\n• ").replace(/<\/li>/gi,"\n"),t=t.replace(/<[^>]+>/g,""),t=t.replace(/&nbsp;/g," ").replace(/&amp;/g,"&").replace(/&lt;/g,"<").replace(/&gt;/g,">").replace(/&#10;?/g,"\n"),t=t.replace(/[ \t]+\n/g,"\n").replace(/\n{3,}/g,"\n\n").replace(/[ \t]{2,}/g," ").trim(),t}(n):s(t||e)}}if(/^additional info review$/i.test(t)||/AdditionalInfoReview/i.test(n)){const t=function(e){for(const t of l(e))try{const e=t.querySelector&&t.querySelector("a[href]");if(e)return e}catch(e){}return null}(e);t&&(f={title:(t.getAttribute("title")||t.textContent||"").trim(),href:t.getAttribute("href")||"#",rowIndex:c})}})),(d||u||f||h)&&t.push({sourceText:d,sourceHtml:u,add:f,rowIndex:c,recordHref:h})})),o("harvestRowsFromGrid -> rows found:",t.length),t.length&&console.table(t.map((e=>({rowIndex:e.rowIndex,hasHtml:!!e.sourceHtml,hasText:!!e.sourceText,add:!!e.add,href:e.recordHref})))),t}const h=e=>(e||"").replace(/\s+/g," ").trim(),m=e=>e?.value??e?.getAttribute?.("value")??e?.textContent??e?.innerText??e?.title??"";function p(e){try{e.dispatchEvent(new MouseEvent("mousedown",{bubbles:!0,cancelable:!0})),e.dispatchEvent(new MouseEvent("mouseup",{bubbles:!0,cancelable:!0})),e.click()}catch(t){try{e.click()}catch(e){}}}async function g(e,{timeout:t=6e3}={}){top?.document||document;const n=function(e){const t=top?.document||document,n=t=>(t||"").replace(/\s+/g," ").trim().toLowerCase()===e.toLowerCase();for(const r of l(t))try{const t=r.querySelector(`[role="tab"][data-label="${e}"]`);if(t)return t;const o=Array.from(r.querySelectorAll('[role="tab"]')).find((e=>n(e.getAttribute("data-label"))||n(e.textContent)));if(o)return o}catch(e){}return null}(e);return!!n&&("true"===n.getAttribute("aria-selected")||(p(n),!!await b((()=>"true"===n.getAttribute("aria-selected")),{timeout:t})))}function y(){const e=top?.document||document,t=(e.title||"").match(a);if(t)return t[0];for(const t of l(e))try{const e=[...t.querySelectorAll("[data-output-element-id='output-field']"),...t.querySelectorAll("lightning-formatted-text[slot='output']"),...t.querySelectorAll("lightning-formatted-text"),...t.querySelectorAll(".slds-page-header__title, h1, h2, [title], [aria-label]")];for(const t of e){const e=[t?.textContent,t?.innerText,t?.title,t?.getAttribute?.("title"),t?.getAttribute?.("aria-label"),t?.getAttribute?.("value")];for(const t of e){const e=(t||"").match(a);if(e)return e[0]}}}catch(e){}try{const t=e.createTreeWalker(e.body,NodeFilter.SHOW_TEXT,null);let n;for(;n=t.nextNode();){const e=(n.nodeValue||"").match(a);if(e)return e[0]}}catch(e){}return null}async function w(e=8e3){let t=y();if(t)return t;const n=Date.now();for(;Date.now()-n<e;)if(await new Promise((e=>setTimeout(e,150))),t=y(),t)return t;return null}function b(e,{interval:t=150,timeout:n=4e3,label:r="waitFor"}={}){return new Promise((a=>{const l=Date.now(),s=()=>{try{const t=e();if(t)return o(r,"-> success"),a(t)}catch(e){i(r,"predicate threw",e)}if(Date.now()-l>=n)return i(r,"-> timeout after",n,"ms"),a(null);setTimeout(s,t)};s()}))}function S(){const e=new Map(Object.keys(t).map((e=>[e.toLowerCase(),e]))),n=t=>{const n=h(t);return n&&e.get(n.toLowerCase())||null},r=top?.document||document;for(const e of l(r)){try{const t=Array.from(e.querySelectorAll("lightning-formatted-text"));for(const e of t){const t=n(m(e));if(t)return t}}catch(e){}try{const t=Array.from(e.querySelectorAll("*")).find((e=>/Responsible\s+Integrated\s+OU/i.test(h(e.textContent))));if(t){const e=t.closest("records-record-layout-item, lightning-layout, div, section")||t.parentElement;if(e){const t=e.querySelector("lightning-formatted-text")||e.querySelector("[data-output-element], [data-value], [title]"),r=n(m(t));if(r)return r}}}catch(e){}}return null}async function x(e){const t=c()[0];if(!t)return o("No Source Info grid found when trying to open row",e),!1;let n=t.querySelector(`[role="row"][aria-rowindex="${e}"]`);if(!n){let r=0,o=null;t.querySelectorAll('[role="row"]').forEach((t=>{t.querySelectorAll('td[role="gridcell"]').length>0&&(r+=1,r===e&&(o=t))})),n=o}if(!n)return o("Row not found for index",e),!1;const r=A(n);if(!r)return o("No anchor in row",e),!1;const i=r.getAttribute("href")||r.href;o("Clicking Source Info row",e,"href:",i,"text:",(r.textContent||"").trim()),p(r);const a=await b((()=>/\/lightning\/r\//i.test(location.href)||document.querySelector("records-record-layout-item")),{timeout:12e3});return o("Navigation after click",a?"ok":"timeout"),!!a}function A(e){const t=function(e){const t=[];for(const n of l(e))try{const e=n.querySelectorAll?n.querySelectorAll("a[href]"):[];e&&t.push(...Array.from(e))}catch(e){}return t}(e);let n=t.find((e=>/SourceInfo-\d{3,}/i.test((e.textContent||"").trim())));return n||(n=t.find((e=>/\/lightning\/r\/a5A\w+\/view/i.test(e.getAttribute("href")||e.href||""))),n||(n=t.find((e=>e.closest&&e.closest("records-hoverable-link"))),n||t[0]||null))}function v(e,t,n,r,o){const i=(e=(e=(e=e.replace(/\r\n|\r/g,"\n")).replace(/(?<!\*)\*(?!\*)/g,"\n*")).replace(/-###-From (SR|PE)-/g,"\n$&")).split("\n").filter((e=>e.trim().length>0)),a=/(\b(?:\d{4}[-/.](?:\d{1,2}|[A-Za-z]{3})[-/.]\d{1,2}|(?:\d{1,2}[-/ ](?:[A-Za-z]{3,9})[-/ ]\d{4})|(?:[A-Za-z]{3,9} \d{1,2}, \d{4})|(?:\d{1,2}[-/]\d{1,2}[-/]\d{4}))(?: \d{1,2}:\d{2}(?::\d{2})?(?: ?[APap][Mm])?)?\b)/;let l=[],s=0,c=0;const d=[];if(i.forEach(((e,i)=>{const u=(e=(e=e.replace(/\s+$/,"")).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;")).match(a),f=!!u;if(f){const n=u[0];e=`<span style="position: relative;" id="lnk${c}">\n             <span class="arrowPointer" id="lnk${c}-arrow">&#x2192;</span>${e}\n           </span>`,"General"===t?(l.push({id:`lnk${c}`,title:n,level:1,start:s,end:i}),s=i+1):(l.length>0&&(l[l.length-1].end=i-1),l.push({id:`lnk${c}`,title:n,level:1,start:i,end:null})),c++}(r||[]).forEach((t=>{!f&&e.indexOf(t)>=0&&(e=`<span style="position: relative;" id="lnk${c}">\n               <span class="arrowPointer" id="lnk${c}-arrow">&#x2192;</span>${e}\n             </span>`,l.push({id:`lnk${c}`,title:t,level:1,start:i,end:i}),c++)})),e=(o||applyCombinedStyles)(e,n||[]),d.push(e)})),l.length>0&&"General"!==t&&(l[l.length-1].end=d.length-1,s=d.length),0===l.length)return{lines:d,links:[]};const u=l.concat().sort(((e,t)=>{const n=new Date(e.title),r=new Date(t.title);return isNaN(n)||isNaN(r)?e.title.localeCompare(t.title):n-r}));return{lines:d,links:u}}function I(e){const t=top?.document||document;for(const n of l(t))try{const t=n.querySelectorAll(".CMPL123TextAreaRichField .slds-form-element_readonly");for(const n of t){const t=n.querySelector(".slds-form-element__label"),r=(t?.textContent||"").trim();if(!e.test(r))continue;const o=n.querySelector(".slds-form-element__control .slds-form-element__static lightning-formatted-rich-text,.slds-form-element__control .slds-form-element__static lightning-output-rich-text,.slds-form-element__control .slds-form-element__static lightning-base-formatted-rich-text");if(!o)continue;const i=o.querySelector('span[part="formatted-rich-text"]')||o.querySelector(".slds-rich-text-editor__output")||o.shadowRoot?.querySelector('span[part="formatted-rich-text"]')||o.shadowRoot?.querySelector(".slds-rich-text-editor__output");return{host:o,inner:i}}}catch(e){}return null}function C(e){if(!e)return"";const t=e.host??e,n=e.inner??null;if(n?.innerHTML)return n.innerHTML;const r=t.querySelector('span[part="formatted-rich-text"]')||t.querySelector(".slds-rich-text-editor__output");if(r?.innerHTML)return r.innerHTML;const o=t.shadowRoot?.querySelector('span[part="formatted-rich-text"]')||t.shadowRoot?.querySelector(".slds-rich-text-editor__output");return o?.innerHTML?o.innerHTML:t.innerHTML||""}!async function(){const e=function(){const e=window.open("about:blank","_blank");if(!e||!e.document)return alert("Couldn’t open a new tab. Please allow popups for this site."),null;try{e.document.open(),e.document.write('<!doctype html><html><head><meta charset="utf-8">\n      <title>Interface Formatter</title>\n      <style>body{font-family:system-ui,sans-serif;padding:24px;color:#1f2937}\n      .muted{opacity:.7}</style></head>\n      <body><h2>Interface Formatter</h2>\n      <p class="muted">Loading…</p></body></html>'),e.document.close()}catch(e){}return e}();if(o("RUN start, url:",location.href),!e)return;const n=function(){const e=top?.document||document;for(const t of l(e))try{const e=t.querySelector('[role="tab"][aria-selected="true"]');if(!e)continue;const n=e.getAttribute("data-label")||e.textContent||"";return h(n)}catch(e){}return null}();o("Active tab at start:",n);const r=await async function(){let e=S();return e||(await g("Details",{timeout:8e3})?(e=await b((()=>S()),{timeout:5e3}),e||null):null)}();o("OUKey:",r);const a={styleWords:[],boldLinesKeyWords:[]};var s,m;if(r&&t[r]?(s=a,(m=t[r])&&(m.styleWords&&s.styleWords.push(...m.styleWords),m.boldLinesKeyWords&&s.boldLinesKeyWords.push(...m.boldLinesKeyWords))):console.warn("[Interface Formatter] OU not found in page or not defined in styles.js.",r),a.styleWords.length){const H=new Set;a.styleWords=a.styleWords.filter((e=>{const t=e.style+"||"+(e.words||[]).join("|");return!H.has(t)&&(H.add(t),!0)}))}const p=await async function(){if(!await g("Source Info")&&!await g("Source Information"))return[];const e=Date.now();for(;Date.now()-e<8e3;){const e=c().flatMap((e=>f(e)));if(e.length)return e;await new Promise((e=>setTimeout(e,200)))}return[]}();u=String(location?.href||document?.URL||""),o("Stored list URL:",u||"(empty)"),o("Stored list URL:",u),o("Total rows to visit:",p.length);const y=String(location?.href||document?.URL||"");o("Stored list URL:",y);let I=[];{const _=c();if(o("findSourceInfosGrids ->",_.length,"grid(s)"),_[0]){const O=Array.from(_[0].querySelectorAll('[role="row"]'));o("Scanning rows:",O.length);let U=0;O.forEach((e=>{if(!(e.querySelectorAll('td[role="gridcell"]').length>0))return;const t=parseInt(e.getAttribute("aria-rowindex")||"",10);U+=1;const n=Number.isFinite(t)?t:U;A(e)&&I.push(n)}))}}o("Total rows with Source Info links:",I.length,I);let C=[];for(let V=0;V<I.length;V++){const B=I[V];if(o(`Row ${V+1}/${I.length} -> opening rowIndex ${B}`),!await x(B)){i("Open failed for rowIndex",B);continue}const G=await d();C.push({rowIndex:B,html:G.html,text:G.text}),history.back(),await b((()=>c().length>0),{timeout:12e3})||(o("history.back() didn't restore grid, reloading list URL…"),location.assign(y),await b((()=>c().length>0),{timeout:12e3})),await(g("Source Info")||g("Source Information"))}o("Collected source info records:",C.length);const T=p.filter((e=>(e.sourceText||e.sourceHtml)&&!e.add)),E=p.filter((e=>e.add&&(e.sourceText||e.sourceHtml)));function W(e){return e.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}function k(e,t,n,r,o,i){if(e.sourceHtml&&e.sourceHtml.trim()){const t=function(e){if(!e)return"";const t=document.createElement("template");t.innerHTML=e;let n=[];const r=e=>{if(e.nodeType===Node.TEXT_NODE)return void n.push(e.nodeValue.replace(/\u00A0/g," "));if(e.nodeType!==Node.ELEMENT_NODE)return;const t=e.tagName;if("BR"!==t){for(const t of Array.from(e.childNodes))r(t);("P"===t||"DIV"===t||"SECTION"===t||"ARTICLE"===t||/^H[1-6]$/.test(t)||"LI"===t)&&n.push("\n")}else n.push("\n")};return r(t.content),n.join("").replace(/\r\n/g,"\n")}(e.sourceHtml).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;");n.push(`<pre class="from-pre">${t}</pre>`)}else if(e.sourceText){const a=v(e.sourceText,t,o,i,M);n.push(...a.lines),r.push(...a.links)}}function M(e,t){let n=[];t.forEach((t=>{t.words.forEach((r=>{const o=/\s/.test(r)?W(r):"\\b"+W(r)+"\\b",i=new RegExp(o,"gi");let a;for(;null!==(a=i.exec(e));)n.push({index:a.index,type:"start",style:t.style}),n.push({index:a.index+a[0].length,type:"end",style:t.style})}))})),n.sort(((e,t)=>e.index!==t.index?e.index-t.index:"start"===e.type?-1:1));let r="",o=0,i=[];if(n.forEach((t=>{if(t.index>o){let n=e.slice(o,t.index);if(i.length>0){let e=i.join(";");r+=`<span style="${e}">${n}</span>`}else r+=n;o=t.index}if("start"===t.type)i.push(t.style);else{let e=i.indexOf(t.style);-1!==e&&i.splice(e,1)}})),o<e.length){let t=e.slice(o);if(i.length>0){let e=i.join(";");r+=`<span style="${e}">${t}</span>`}else r+=t}return r}if(o("Rows with Source Info:",T.length,"flagged:",E.length),await w(),n&&(await g(n)||(/^details$/i.test(n)?await g("Details"):/source info(rmation)?/i.test(n)&&(await g("Source Information")||await g("Source Info")))),a.styleWords.length||a.boldLinesKeyWords.length){var F=a.styleWords,P=a.boldLinesKeyWords;F.forEach((e=>{e.words.sort(((e,t)=>t.length-e.length))}));var R=[],L=[];const z=await w()||"Record";if(T.length){const Z="Source Information",X=Z.replace(/\W/gi,"");R.push('<div class="card">'),R.push('<h2 id="'+X+'"><span class="arrowPointer" id="'+X+'-arrow">&#x2192;</span>'+Z+"</h2>"),L.push({id:X,title:Z}),T.forEach((e=>k(e,Z,R,L,F,P))),R.push("</div>")}if(E.length){const J="Additional Source Information",Y=J.replace(/\W/gi,"");R.push('<div class="card">'),R.push('<h2 id="'+Y+'"><span class="arrowPointer" id="'+Y+'-arrow">&#x2192;</span>'+J+"</h2>"),L.push({id:Y,title:J}),E.forEach((e=>k(e,J,R,L,F,P))),R.push("</div>")}var D=R.join(""),N=[],q=null;L.forEach((function(e){e.level?q?q.children.push(e):(q={header:{id:"default",title:"Default"},children:[e]},N.push(q)):(q={header:e,children:[]},N.push(q))}));var $=[];$.push('<div id="modern-nav">'),$.push(`<div class="brand">Interface Formatter<br/>${z}</div>`);const j=r?`OU: ${r}`:"OU: Unknown";function K(t){try{e.document.open(),e.document.write(`<!doctype html><html><head><meta charset="utf-8">\n          <title>Interface Formatter</title></head>\n          <body>${t}</body></html>`),e.document.close()}catch(n){setTimeout((()=>{try{e.document.open(),e.document.write(`<!doctype html><html><head><meta charset="utf-8">\n              <title>Interface Formatter</title></head>\n              <body>${t}</body></html>`),e.document.close()}catch(e){}}),100)}}$.push("<ul>"),$.push(`<li class="ou-pill">${j}</li>`),N.forEach((e=>{$.push("<li>"),$.push(`<a href="#" class="nav-link" data-target="${e.header.id}">\n          ${e.header.title}\n        </a>`),e.children&&e.children.length>0&&($.push("<ul>"),e.children.forEach((e=>{$.push(`<li>\n              <a href="#" class="nav-link" data-target="${e.id}">\n                ${e.title}\n              </a>\n            </li>`)})),$.push("</ul>")),$.push("</li>")})),$.push("</ul>"),$.push("</div>"),$.push(`<div id="main-content">${D}</div>`),K('\n  <style>\n  body {\n    margin: 0;\n    padding: 0;\n    font-family: system-ui, sans-serif;\n    background: #EEF2F7;\n  }\n  #modern-nav {\n    position: fixed;\n    top: 0;\n    left: 0;\n    width: 280px;\n    height: 100vh;\n    background: #2C5282;\n    color: #fff;\n    padding: 20px;\n    box-shadow: 3px 0 8px rgba(0, 0, 0, 0.15);\n    overflow-y: auto;\n    box-sizing: border-box;\n    z-index: 9999;\n  }\n  .from-rich,\n  .from-rich p,\n  .from-rich div,\n  .from-rich span,\n  .from-rich [part="formatted-rich-text"] {\n    white-space: break-spaces;   /* preserves spaces, tabs, and newlines */\n    line-break: anywhere;        /* avoid overflow while keeping whitespace */\n  }\n  .from-pre {\n    white-space: pre-wrap;   /* preserve newlines/tabs/spaces, allow wrapping */\n    font: inherit;           /* match the surrounding font */\n    margin: 0 0 12px 0;      /* similar spacing to your <p> stack */\n    line-height: 1.5;\n  }\n  .ou-pill{\n    margin: 4px 0 12px 0;\n    display: inline-block;\n    padding: 6px 10px;\n    border-radius: 9999px;\n    background: rgba(255,255,255,0.15);\n    color: #E6F6FF;\n    font-weight: 600;\n    letter-spacing:.2px;\n  }\n  .brand small{ display:block; opacity:.85; font-weight:600; margin-top:2px; }\n  .brand {\n    font-size: 1.4rem;\n    font-weight: 900;\n    margin-bottom: 24px;\n    background: linear-gradient(90deg, #BEE3E8 0%, #63B3ED 100%);\n    -webkit-background-clip: text;\n    -webkit-text-fill-color: transparent;\n    letter-spacing: 1px;\n    line-height: 1.4;\n  }\n  #modern-nav ul {\n    list-style: none;\n    margin: 0;\n    padding: 0;\n  }\n  #modern-nav li {\n    margin-bottom: 8px;\n  }\n  #modern-nav ul ul {\n    padding-left: 1.2em;\n  }\n  #modern-nav a {\n    color: #F8FAFC;\n    text-decoration: none;\n    display: inline-block;\n    padding: 5px 0;\n    border-radius: 4px;\n    transition: transform 0.25s ease, background 0.25s ease;\n  }\n  #modern-nav a:hover {\n    background: rgba(255,255,255,0.1);\n    transform: scale(1.05);\n  }\n  #main-content {\n    margin-left: 300px;\n    padding: 20px;\n    box-sizing: border-box;\n    min-height: 100vh;\n  }\n  .card {\n    background: #fff;\n    border-radius: 8px;\n    box-shadow: 0 2px 6px rgba(0, 0, 0, 0.1);\n    padding: 20px;\n    margin-bottom: 20px;\n    box-sizing: border-box;\n    word-wrap: break-word;\n    white-space: normal;\n    line-height: 1.5;\n  }\n  h2 {\n    margin-top: 0;\n    margin-bottom: 12px;\n    font-size: 1.2rem;\n    border-bottom: 2px solid #3182FE;\n    padding-bottom: 6px;\n    color: #2D3748;\n  }\n  @media (max-width: 768px) {\n    #modern-nav {\n      position: static;\n      width: 100%;\n      height: auto;\n      box-shadow: none;\n      margin-bottom: 10px;\n    }\n    #main-content {\n      margin-left: 0;\n      min-height: auto;\n    }\n  }\n  .arrowPointer {\n    color: red !important;\n    background-color: white;\n    font-weight: bold;\n    display: none;\n    font-size: 1.2em;\n    margin-right: 5px;\n    animation: arrowFade 3s ease-out;\n  }\n  @keyframes arrowFade {\n    0% { opacity: 1; }\n    100% { opacity: 0; }\n  }\n  </style>\n  '+$.join("")+"\n      <script>\n        console.log('Nav is fixed on wide screens, stacked on top at narrow. Date-based line re-ordering applied.');\n      <\/script>\n    ")}}()})();